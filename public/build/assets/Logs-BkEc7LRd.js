import{c as d,r as w,b as l,d as e,e as u,f,n as c,g as v,F as p,i as x,t as n,o as a,y as E,m as H,h as j,z as L}from"./app-BG8bJDk_.js";import{_ as O}from"./Breadcrumbs-BJkTr2TQ.js";import{_ as V,a as A}from"./MainHeader-CSzL04-A.js";import{_ as D}from"./MainSidebar-Gh5823Zl.js";const z={class:"relative min-h-screen overflow-hidden bg-[#f7f1e6] text-slate-900"},F={class:"relative mx-auto flex max-w-[1360px] flex-col gap-8 px-6 py-8"},T={class:"rounded-3xl border border-slate-200/80 bg-white/90 p-6 shadow-sm page-content-wrapper"},M={key:0,class:"mt-6 flex flex-wrap gap-3"},I={key:1,class:"mt-6 rounded-2xl border border-dashed border-slate-200 bg-white p-6 text-sm text-slate-600"},J={key:2,class:"mt-6 rounded-2xl border border-slate-200 bg-slate-50 p-4"},P={class:"mt-2 text-lg font-semibold text-slate-900"},q={key:0,class:"mt-4 space-y-3"},G=["onDblclick"],K={class:"font-semibold text-slate-800"},Q={class:"text-slate-600"},R={key:1,class:"mt-4 rounded-2xl border border-dashed border-slate-200 bg-white p-4 text-sm text-slate-600"},U={key:2,class:"mt-4 flex flex-wrap items-center gap-2 text-sm"},W={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 px-4"},X={class:"w-full max-w-2xl rounded-3xl border border-slate-200 bg-white shadow-xl"},Y={class:"popup-body max-h-[500px] overflow-y-auto px-6 pt-4"},Z={class:"text-sm text-slate-600"},ee={class:"mt-4 grid gap-3 rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm text-slate-700"},te={class:"flex items-center justify-between gap-3"},se={class:"font-semibold text-slate-800"},ae={class:"flex items-center justify-between gap-3"},le={class:"flex items-center justify-between gap-3"},re={class:"flex items-center justify-between gap-3"},ne={class:"mt-4"},oe={key:0,class:"mt-2 space-y-2"},ie={class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},de={class:"mt-1 grid gap-2 text-sm"},ue={class:"flex items-start justify-between gap-3"},ce={class:"text-right"},pe={class:"flex items-start justify-between gap-3"},xe={class:"text-right"},be={key:1,class:"mt-2 rounded-2xl border border-dashed border-slate-200 bg-white p-4 text-sm text-slate-600"},ye={__name:"Logs",props:{appName:{type:String,default:"Laravel"},navigation:{type:Object,default:()=>({title:"Разделы",data:[]})},activeHref:{type:String,default:""},entities:{type:Array,default:()=>[]},activeEntity:{type:Object,default:null},logs:{type:Object,default:()=>({data:[],links:[]})},breadcrumbs:{type:Array,default:()=>[]}},setup(o){const b=o,g=d(()=>b.navigation?.data??[]),h=d(()=>(g.value?.length??0)>0),N=d(()=>b.entities.length>0),$=d(()=>b.logs?.data?.length>0),y={created:"Создание",updated:"Редактирование",deleted:"Удаление"},C={created:"text-emerald-600",updated:"text-amber-600",deleted:"text-rose-600"},i=w(null),m=w(!1),S=r=>!Array.isArray(r)||r.length===0?"—":r.join(", "),B=r=>{i.value=r,m.value=!0},_=()=>{m.value=!1,i.value=null},k=r=>r==null||r===""?"—":typeof r=="object"?JSON.stringify(r):String(r);return(r,t)=>(a(),l("div",z,[t[12]||(t[12]=e("div",{class:"pointer-events-none absolute -left-28 top-12 h-72 w-72 rounded-full bg-emerald-200/70 blur-3xl"},null,-1)),t[13]||(t[13]=e("div",{class:"pointer-events-none absolute -right-24 -top-24 h-80 w-80 rounded-full bg-amber-200/70 blur-3xl"},null,-1)),e("div",F,[f(V,{"app-name":o.appName,"is-authenticated":!!r.$page.props.auth?.user,"login-label":r.$page.props.auth?.user?.login},null,8,["app-name","is-authenticated","login-label"]),e("main",{class:c(["grid gap-6",{"lg:grid-cols-[240px_1fr]":h.value}])},[h.value?(a(),v(D,{key:0,title:o.navigation.title,data:g.value,"active-href":o.activeHref},null,8,["title","data","active-href"])):u("",!0),e("div",T,[f(O,{items:o.breadcrumbs},null,8,["items"]),t[2]||(t[2]=e("h1",{class:"text-3xl font-semibold text-slate-900"},"Логи",-1)),t[3]||(t[3]=e("p",{class:"mt-4 text-sm text-slate-600"}," Выберите сущность, чтобы просмотреть журнал изменений. ",-1)),N.value?(a(),l("div",M,[(a(!0),l(p,null,x(o.entities,s=>(a(),v(j(L),{key:s.key,class:c(["rounded-full border border-slate-200 bg-slate-50 px-4 py-2 text-sm font-medium text-slate-700 transition hover:-translate-y-0.5 hover:border-slate-300",s.href===o.activeHref?"border-slate-900 bg-slate-900 text-white":""]),href:s.href},{default:E(()=>[H(n(s.label),1)]),_:2},1032,["class","href"]))),128))])):(a(),l("div",I," Для вашей роли пока нет доступных журналов. ")),o.activeEntity?(a(),l("div",J,[t[1]||(t[1]=e("p",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Выбранная сущность",-1)),e("p",P,n(o.activeEntity.label),1),$.value?(a(),l("div",q,[t[0]||(t[0]=e("div",{class:"grid grid-cols-[160px_140px_1fr_140px] gap-4 border-b border-slate-200 pb-2 text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},[e("div",null,"Сущность"),e("div",null,"Действие"),e("div",null,"Поля"),e("div",null,"Дата")],-1)),(a(!0),l(p,null,x(o.logs.data,s=>(a(),l("div",{key:s.id,class:"grid grid-cols-[160px_140px_1fr_140px] gap-4 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-700",onDblclick:me=>B(s)},[e("div",K,n(s.entity_label||"—"),1),e("div",{class:c(["font-semibold",C[s.action]||"text-slate-600"])},n(y[s.action]||s.action||"—"),3),e("div",Q,n(S(s.fields)),1),e("div",null,n(s.created_at||"—"),1)],40,G))),128))])):(a(),l("div",R," Логи пока не найдены. ")),o.logs.links?.length?(a(),l("div",U,[(a(!0),l(p,null,x(o.logs.links,s=>(a(),v(j(L),{key:s.label,class:c(["rounded-full border border-slate-200 px-3 py-1 text-slate-600 transition hover:-translate-y-0.5 hover:border-slate-300",{"bg-slate-900 text-white":s.active,"pointer-events-none opacity-50":!s.url}]),href:s.url||"",innerHTML:s.label},null,8,["class","href","innerHTML"]))),128))])):u("",!0)])):u("",!0)])],2),f(A,{"app-name":o.appName},null,8,["app-name"])]),m.value?(a(),l("div",W,[e("div",X,[e("div",{class:"popup-header flex items-center justify-between border-b border-slate-200/80 px-6 py-4"},[t[4]||(t[4]=e("h2",{class:"text-lg font-semibold text-slate-900"},"Детали лога",-1)),e("button",{class:"rounded-full border border-slate-200 px-2.5 py-1 text-sm text-slate-500 transition hover:border-slate-300 hover:text-slate-700",type:"button","aria-label":"Закрыть",onClick:_}," x ")]),e("div",Y,[e("p",Z,n(i.value?.entity_label||"—")+" • #"+n(i.value?.entity_id||"—"),1),e("div",ee,[e("div",te,[t[5]||(t[5]=e("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Действие",-1)),e("span",se,n(y[i.value?.action]||i.value?.action||"—"),1)]),e("div",ae,[t[6]||(t[6]=e("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Пользователь",-1)),e("span",null,n(i.value?.actor?.login||"—"),1)]),e("div",le,[t[7]||(t[7]=e("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"IP",-1)),e("span",null,n(i.value?.ip||"—"),1)]),e("div",re,[t[8]||(t[8]=e("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Дата",-1)),e("span",null,n(i.value?.created_at||"—"),1)])]),e("div",ne,[t[11]||(t[11]=e("p",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Изменения",-1)),i.value?.changes?(a(),l("div",oe,[(a(!0),l(p,null,x(i.value.fields||[],s=>(a(),l("div",{key:s,class:"rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-700"},[e("div",ie,n(s),1),e("div",de,[e("div",ue,[t[9]||(t[9]=e("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-400"},"Было",-1)),e("span",ce,n(k(i.value.changes?.before?.[s])),1)]),e("div",pe,[t[10]||(t[10]=e("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-400"},"Стало",-1)),e("span",xe,n(k(i.value.changes?.after?.[s])),1)])])]))),128))])):(a(),l("div",be," Детали изменений недоступны. "))])]),e("div",{class:"popup-footer flex flex-wrap justify-end gap-3 border-t border-slate-200/80 px-6 py-4"},[e("button",{class:"rounded-full border border-slate-200 px-4 py-2 text-sm text-slate-600 transition hover:-translate-y-0.5 hover:border-slate-300",type:"button",onClick:_}," Закрыть ")])])])):u("",!0)]))}};export{ye as default};
