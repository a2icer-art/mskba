import{u as bt,r as p,c as m,a as Ie,w as qe,p as ae,q as Pe,D as ft,b as a,d as t,e as c,f as Y,n as E,g as yt,t as d,F as b,i as g,E as ge,C as he,h as i,l as _e,m as U,j as k,v as gt,k as R,o as l}from"./app-BG8bJDk_.js";import{_ as ht}from"./AuthModal-C85lGBWW.js";import{_ as _t}from"./Breadcrumbs-BJkTr2TQ.js";import{_ as kt}from"./EventCreateModal-CbqUTWpy.js";import{_ as wt,a as St}from"./MainHeader-CSzL04-A.js";import{_ as Ct}from"./MainSidebar-Gh5823Zl.js";const Et={class:"relative min-h-screen overflow-x-hidden bg-[#f7f1e6] text-slate-900"},Rt={class:"relative mx-auto flex max-w-[1360px] flex-col gap-8 px-6 py-8"},jt={class:"flex flex-wrap items-center justify-between gap-4"},$t={class:"text-3xl font-semibold text-slate-900"},Bt={key:0,class:"mt-2 flex items-center gap-2 text-sm text-slate-700"},Tt={class:"flex items-center gap-1 text-amber-400"},Dt={class:"font-semibold"},At={key:0,class:"text-slate-500"},Ft={class:"mt-6"},Nt={class:"mt-3 flex flex-wrap gap-2"},Ut=["onClick"],Lt={class:"mt-6 space-y-10"},Vt=["id"],Mt={class:"overflow-hidden rounded-2xl border border-slate-200 bg-slate-50"},Ot={key:0,class:"border-t border-slate-200 px-4 py-3 text-sm text-rose-700"},It={class:"space-y-2"},qt={key:0,class:"flex items-center gap-2 text-sm text-slate-700"},Pt={class:"text-sm text-slate-700"},zt=["href"],Yt=["id"],Ht={class:"flex items-center justify-between gap-3"},Wt=["href"],Kt={class:"hidden grid-cols-7 gap-3 text-xs uppercase tracking-[0.2em] text-slate-400 sm:grid"},Qt={key:0,class:"grid gap-3 md:grid-cols-3 lg:grid-cols-7"},Zt=["onClick"],Gt={class:"text-xs uppercase tracking-[0.2em] text-slate-500"},Jt={class:"sm:hidden"},Xt={key:0,class:"absolute right-4 top-7.5 h-2 w-2 rounded-full bg-violet-500"},es={class:"text-sm text-slate-700"},ts={key:0,class:"text-rose-700"},ss={key:1,class:"space-y-1"},ls={key:2,class:"text-slate-500"},as={key:1,class:"text-sm text-slate-500"},os={key:2,class:"mt-4 flex flex-wrap gap-3 text-xs text-slate-600"},rs=["id"],ns={class:"flex items-center justify-between gap-3"},ds=["href"],is=["id"],us={class:"flex items-center justify-between gap-3"},cs=["href"],ps={class:"flex items-center justify-between gap-4"},vs={class:"flex flex-wrap items-center gap-2 text-sm font-medium text-slate-800"},ms=["title"],xs={key:1,class:"rounded-full border border-rose-200 bg-rose-50 px-2 py-0.5 text-xs font-semibold text-rose-700"},bs=["title"],fs=["title"],ys=["disabled"],gs=["disabled"],hs={class:"mt-3"},_s={key:0,class:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700"},ks={class:"mt-1 list-disc space-y-1 pl-4"},ws={key:1,class:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700"},Ss={key:2,class:"rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600"},Cs={key:3,class:"rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700"},Es={key:4,class:"rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-700"},Rs={class:"mt-6 rounded-2xl border border-slate-200 bg-slate-50 p-4"},js={class:"flex items-center justify-between border-b border-slate-100 py-3 last:border-b-0"},$s={class:"text-sm font-medium text-slate-800"},Bs={class:"flex items-center justify-between border-b border-slate-100 py-3 last:border-b-0"},Ts={class:"text-sm font-medium text-slate-800"},Ds={class:"flex items-center justify-between border-b border-slate-100 py-3 last:border-b-0"},As={class:"text-sm font-medium text-slate-800"},Fs={class:"flex items-center justify-between border-b border-slate-100 py-3 last:border-b-0"},Ns={class:"text-sm font-medium text-slate-800"},Us={class:"flex items-center justify-between border-b border-slate-100 py-3 last:border-b-0"},Ls={class:"text-sm font-medium text-slate-800"},Vs={class:"flex items-center justify-between border-b border-slate-100 py-3 last:border-b-0"},Ms={class:"text-sm font-medium text-slate-800"},Os={class:"w-full max-w-lg rounded-3xl border border-slate-200 bg-white shadow-xl"},Is={class:"popup-header flex items-center justify-between border-b border-slate-200/80 px-6 py-4"},qs={class:"mt-1 text-sm text-slate-500"},Ps={key:0,class:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},zs={key:1,class:"flex min-h-[180px] items-center justify-center rounded-2xl border border-slate-200 bg-slate-50"},Ys={key:0,class:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},Hs={key:1,class:"rounded-2xl border border-amber-200 bg-amber-50 px-4 py-3 text-sm text-amber-800"},Ws={key:2,class:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-xs font-normal text-slate-600"},Ks={key:0,class:"mt-2 space-y-1"},Qs={key:1,class:"mt-2 text-slate-500"},Zs={key:3},Gs={class:"mt-4 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-sm text-slate-700"},Js={key:0,class:"text-sm text-slate-600"},Xs={key:1,class:"mt-2 text-sm text-slate-700"},el={key:4,class:"mt-4"},tl={key:0,class:"mt-2 flex flex-wrap gap-2"},sl={key:1,class:"mt-2 text-sm text-slate-500"},ll={class:"popup-footer flex flex-wrap justify-end gap-3 border-t border-slate-200/80 px-6 py-4"},al=["disabled"],ol={class:"w-full max-w-lg rounded-3xl border border-slate-200 bg-white shadow-xl"},rl={class:"popup-body max-h-[500px] overflow-y-auto px-6 pt-4"},nl={key:0,class:"mt-3 rounded-2xl border border-slate-200 bg-slate-50 px-3 py-2 text-xs text-slate-600"},dl={class:"font-semibold text-slate-700"},il={key:0,class:"mt-2 space-y-2"},ul={class:"text-[10px] uppercase tracking-[0.15em] text-slate-500"},cl={class:"text-xs font-medium text-slate-800"},pl={key:1,class:"mt-4 flex flex-col gap-3"},vl={key:0},ml={class:"flex flex-col gap-1 text-xs uppercase tracking-[0.15em] text-slate-500"},xl=["value"],bl={key:0,class:"text-xs text-rose-700"},fl={key:1},yl={class:"flex flex-col gap-1 text-xs uppercase tracking-[0.15em] text-slate-500"},gl={key:0,class:"text-xs text-rose-700"},hl={key:2,class:"relative"},_l={class:"flex flex-col gap-1 text-xs uppercase tracking-[0.15em] text-slate-500"},kl={key:0,class:"text-xs text-rose-700"},wl={key:1,class:"absolute left-0 right-0 z-10 mt-2 w-full rounded-2xl border border-slate-200 bg-white text-sm text-slate-700"},Sl=["disabled","onClick"],Cl={key:2,class:"text-xs text-rose-700"},El={key:3},Rl={class:"flex flex-col gap-1 text-xs uppercase tracking-[0.15em] text-slate-500"},jl={key:0,class:"text-xs text-rose-700"},$l={key:4},Bl={class:"flex flex-col gap-1 text-xs uppercase tracking-[0.15em] text-slate-500"},Tl={key:0,class:"text-xs text-rose-700"},Dl={key:2,class:"mt-3 rounded-2xl border border-rose-200 bg-rose-50 px-3 py-2 text-xs text-rose-700"},Al={key:3,class:"mt-3 rounded-2xl border border-emerald-200 bg-emerald-50 px-3 py-2 text-xs text-emerald-700"},Fl={class:"popup-footer flex flex-wrap justify-end gap-3 border-t border-slate-200/80 px-6 py-4"},Nl=["disabled"],Ul=["disabled"],Pl={__name:"VenueShow",props:{appName:{type:String,default:"Laravel"},venue:{type:Object,default:null},moderationRequest:{type:Object,default:null},navigation:{type:Object,default:()=>({title:"Площадки",data:[]})},activeTypeSlug:{type:String,default:""},types:{type:Array,default:()=>[]},editableFields:{type:Array,default:()=>[]},canEdit:{type:Boolean,default:!1},canSubmitModeration:{type:Boolean,default:!1},about:{type:Object,default:()=>({})},breadcrumbs:{type:Array,default:()=>[]}},setup(v){const n=v,H=bt(),L=p(!1),W=p("login"),ke=m(()=>n.navigation?.data??n.navigation?.items??[]),we=m(()=>(ke.value?.length??0)>0),K=Ie({}),Q=p(""),B=p([]),oe=p(!1),V=p(""),M=p(""),h=p([]),f=p(""),Z=p(!1),re=p(!1);let ne=null,O=0;const r=Ie({name:"",venue_type_id:"",commentary:"",city:"",metro_id:"",street:"",building:"",str_address:""}),ze=m(()=>n.types??[]),T=m(()=>n.about??{}),G=m(()=>T.value?.schedule_days??[]),Ye=m(()=>T.value?.schedule_url??""),Se=m(()=>T.value?.feed_url??""),Ce=m(()=>T.value?.rating??null),Ee=m(()=>T.value?.rating_count??null),Re=m(()=>T.value?.map_api_key??""),je=m(()=>{const o=n.venue?.address?.display;return o?`https://yandex.ru/maps/?text=${encodeURIComponent(o)}`:""}),_=m(()=>n.editableFields??[]),He=m(()=>["city","street","building","metro_id"].some(o=>_.value.includes(o))),We=m(()=>n.canEdit),de=m(()=>n.canSubmitModeration),I=m(()=>n.venue?.status==="confirmed"),J=m(()=>n.venue?.status==="moderation"),X=m(()=>n.venue?.status&&n.venue?.status!=="confirmed"),$e=m(()=>{const o=["city","street","building","metro_id"],e={venue_type_id:"Тип",name:"Название",commentary:"Комментарий"},s={venue_type_id:n.venue?.type?.name??"-",name:n.venue?.name??"-",commentary:n.venue?.commentary??"-"},u=Object.keys(e).filter(y=>!_.value.includes(y)).map(y=>({key:y,label:e[y],value:s[y]??"-"}));if(o.some(y=>!_.value.includes(y))){const xt=[n.venue?.address?.city,n.venue?.address?.street,n.venue?.address?.building].filter(Boolean).join(", ")||"-";u.push({key:"address",label:"Адрес",value:xt}),n.venue?.address?.metro&&u.push({key:"address_metro",label:"Метро",value:fe(n.venue?.address?.metro)})}return u});qe(()=>G.value.length,()=>{ae(()=>{le()})});const j=[{id:"address",label:"Адрес"},{id:"schedule",label:"Расписание"},{id:"posts",label:"Посты"},{id:"reviews",label:"Отзывы"}],Be=p("address"),ie=p({}),ee=o=>e=>{e&&(ie.value[o]=e)},ue=p(null),D=p(0),Te=p(0),De=p(0),Ae=p(0),te=p(!1),Fe=p(null),se=p(0),ce=()=>{const o=getComputedStyle(document.documentElement).getPropertyValue("--app-header-offset"),e=parseInt(o,10);se.value=Number.isFinite(e)?e:0},Ke=o=>{const e=ie.value[o];if(!e)return;const s=se.value+D.value+16,u=window.scrollY+e.getBoundingClientRect().top-s;window.scrollTo({top:u,behavior:"smooth"})};let A=null;const le=()=>{if(!ue.value)return;const o=ue.value.getBoundingClientRect(),e=Fe.value?.getBoundingClientRect?.();D.value=o.height,Te.value=window.scrollY+o.top,De.value=e?.left??o.left,Ae.value=e?.width??o.width},pe=()=>{A||(A=window.requestAnimationFrame(()=>{A=null;const o=Te.value+D.value;D.value>0&&(te.value=window.scrollY>=o);let e=j[0]?.id??"";const s=se.value+D.value+24;j.forEach(u=>{const C=ie.value[u.id];if(!C)return;C.getBoundingClientRect().top-s<=0&&(e=u.id)}),e&&(Be.value=e)}))};Pe(()=>{ae(()=>{ce(),le(),pe()}),window.addEventListener("scroll",pe,{passive:!0}),window.addEventListener("resize",le),window.addEventListener("resize",ce)}),ft(()=>{window.removeEventListener("scroll",pe),window.removeEventListener("resize",le),window.removeEventListener("resize",ce),A&&(window.cancelAnimationFrame(A),A=null)});const x=p(null),w=p(!1),S=p(!1),q=p(""),Qe=o=>{x.value={date:o.date,is_today:o.is_today,is_closed:!1,is_closed_by_exception:!1,intervals:[],bookings:[],comment:null},S.value=!0,q.value="",w.value=!1,Xe(o.date)},F=()=>{x.value=null,w.value=!1,ve.value={},S.value=!1,q.value=""},Ze=()=>{w.value=!1},ve=p({}),N=p(null),Ne=p(null),Ue=p(null),Ge=()=>{const o=Ue.value,e=Ne.value;if(!o||!e)return;const s=Math.max(e.offsetTop-o.offsetTop-8,0);o.scrollTo({top:s,behavior:"smooth"})},Je=async()=>{if(!(!x.value?.date||!n.venue?.alias||!n.activeTypeSlug))try{const o=new URLSearchParams({date:x.value.date}),e=await fetch(`/venues/${n.activeTypeSlug}/${n.venue.alias}/schedule-day-bookings?${o.toString()}`);if(!e.ok)return;const s=await e.json();x.value.bookings=s?.bookings??[]}catch{return}},Xe=async o=>{if(!o||!n.venue?.alias||!n.activeTypeSlug){S.value=!1;return}try{const e=new URLSearchParams({date:o}),s=await fetch(`/venues/${n.activeTypeSlug}/${n.venue.alias}/schedule-day?${e.toString()}`);if(!s.ok)throw new Error("day_failed");const u=await s.json();x.value={date:o,is_today:u?.is_today??!1,is_closed:u?.is_closed??!1,is_closed_by_exception:u?.is_closed_by_exception??!1,intervals:u?.intervals??[],bookings:u?.bookings??[],comment:u?.comment??null}}catch{q.value="Не удалось загрузить данные дня."}finally{S.value=!1}},et=()=>{x.value&&(ve.value={venue:n.venue?.alias||"",date:x.value.date||""},w.value=!0,ae(()=>{Ge()}))},tt=()=>{ae(()=>{N.value?.focusType?.()})},st=()=>{!N.value||N.value.isDisabled||N.value.submit()},lt=m(()=>N.value?.isDisabled??!0),Le=o=>new Intl.DateTimeFormat("ru-RU",{day:"numeric",month:"short"}).format(new Date(o)),at=o=>new Intl.DateTimeFormat("ru-RU",{weekday:"short"}).format(new Date(o)),ot=["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],me=p(null),P=p("");let xe=null;const rt=()=>new Promise((o,e)=>{if(window.ymaps){o(window.ymaps);return}if(!Re.value){e(new Error("API key not provided"));return}const s=document.querySelector("script[data-ymaps]");if(s){s.addEventListener("load",()=>o(window.ymaps)),s.addEventListener("error",()=>e(new Error("failed")));return}const u=document.createElement("script");u.src=`https://api-maps.yandex.ru/2.1/?apikey=${Re.value}&lang=ru_RU`,u.async=!0,u.dataset.ymaps="true",u.onload=()=>o(window.ymaps),u.onerror=()=>e(new Error("failed")),document.head.appendChild(u)}),nt=async()=>{if(!me.value)return;const o=n.venue?.address?.display;if(!o){P.value="Адрес не указан.";return}try{const e=await rt();await e.ready();const u=(await e.geocode(o)).geoObjects.get(0);if(!u){P.value="Не удалось определить координаты.";return}const C=u.geometry.getCoordinates();xe=new e.Map(me.value,{center:C,zoom:15,controls:[]},{suppressMapOpenBlock:!0}),xe.behaviors.disable("scrollZoom");const y=new e.Placemark(C,{},{preset:"islands#redIcon"});xe.geoObjects.add(y)}catch{P.value="Не удалось загрузить карту."}};Pe(()=>{nt()});const $=m(()=>n.moderationRequest??null),Ve=m(()=>$.value?.status==="pending"),z=m(()=>$.value?.status==="rejected"),dt=m(()=>$.value?.reviewed_at??$.value?.submitted_at),it=m(()=>$.value?.reject_reason??""),Me=m(()=>!!$.value?.reject_reason);qe(()=>H.props.errors,o=>{if(o?.email||o?.participant_role_id){W.value="register",L.value=!0;return}o?.login&&(W.value="login",L.value=!0)},{immediate:!0});const be=o=>{if(!o)return"-";const e=new Date(o);return Number.isNaN(e.getTime())?o:e.toLocaleString("ru-RU")},fe=o=>o?o.line_name?`${o.name} — ${o.line_name}`:o.name:"-",ut=()=>{V.value="",r.clearErrors(),r.name=n.venue?.name??"",r.venue_type_id=n.venue?.venue_type_id??n.venue?.type?.id??"",r.metro_id=n.venue?.address?.metro_id??n.venue?.address?.metro?.id??"",r.commentary=n.venue?.commentary??"",r.city=n.venue?.address?.city??"",r.street=n.venue?.address?.street??"",r.building=n.venue?.address?.building??"",r.str_address=I.value||J.value?n.venue?.str_address??"":n.venue?.address?.str_address??"",M.value=n.venue?.address?.display??"",h.value=[],f.value="",oe.value=!0},ye=()=>{oe.value=!1,r.reset("name","venue_type_id","metro_id","commentary","city","street","building","str_address"),r.clearErrors(),M.value="",h.value=[],f.value=""},ct=()=>{V.value="",r.transform(o=>{const e={};return _.value.forEach(s=>{s in o&&(e[s]=o[s])}),e}).patch(`/venues/${n.activeTypeSlug}/${n.venue?.alias}`,{preserveScroll:!0,onSuccess:()=>{V.value="Площадка обновлена."}})},pt=o=>{if(re.value){re.value=!1;return}f.value="",r.city="",r.street="",r.building="",r.metro_id="",r.str_address="",ne&&clearTimeout(ne);const e=o?.trim()??"";if(e.length<3){h.value=[];return}ne=setTimeout(()=>{vt(e)},350)},vt=async o=>{const e=++O;Z.value=!0;try{const s=await fetch(`/integrations/address-suggest?query=${encodeURIComponent(o)}`,{credentials:"same-origin"});if(!s.ok){if(e!==O)return;h.value=[],f.value="Не удалось получить подсказки.";return}const u=await s.json();if(e!==O)return;h.value=u?.suggestions??[],h.value.length?f.value="":f.value="Варианты не найдены."}catch{if(e!==O)return;h.value=[],f.value="Не удалось получить подсказки."}finally{if(e!==O)return;Z.value=!1}},mt=o=>{if(!o?.has_house){f.value="Выберите вариант с номером дома.";return}re.value=!0,M.value=o.label||"",r.city=o.city||"",r.street=o.street||"",r.building=o.building||"",r.str_address=o.label||"",r.metro_id=o.metro_id||"",h.value=[],f.value=""},Oe=()=>{if(Q.value="",B.value=[],!de.value){B.value=["Недостаточно прав для отправки на модерацию."];return}K.post(`/venues/${n.activeTypeSlug}/${n.venue?.alias}/moderation-request`,{preserveScroll:!0,onSuccess:()=>{Q.value="Заявка отправлена на модерацию."},onError:o=>{o.moderation&&(B.value=o.moderation.split(`
`).filter(Boolean))},onFinish:()=>{H.props?.errors?.moderation&&(B.value=H.props.errors.moderation.split(`
`).filter(Boolean))}})};return(o,e)=>(l(),a("div",Et,[e[45]||(e[45]=t("div",{class:"pointer-events-none absolute -left-28 top-12 h-72 w-72 rounded-full bg-emerald-200/70 blur-3xl"},null,-1)),e[46]||(e[46]=t("div",{class:"pointer-events-none absolute -right-24 -top-24 h-80 w-80 rounded-full bg-amber-200/70 blur-3xl"},null,-1)),t("div",Rt,[Y(wt,{"app-name":v.appName,"is-authenticated":!!o.$page.props.auth?.user,"login-label":o.$page.props.auth?.user?.login,onOpenLogin:e[0]||(e[0]=s=>{W.value="login",L.value=!0})},null,8,["app-name","is-authenticated","login-label"]),t("main",{class:E(["grid gap-6",{"lg:grid-cols-[240px_1fr]":we.value}])},[we.value?(l(),yt(Ct,{key:0,title:v.navigation.title,data:ke.value,"active-href":v.activeTypeSlug&&v.venue?.alias?`/venues/${v.activeTypeSlug}/${v.venue?.alias}`:""},null,8,["title","data","active-href"])):c("",!0),t("div",{ref_key:"pageContentRef",ref:Fe,class:"rounded-3xl border border-slate-200/80 bg-white/90 p-6 shadow-sm page-content-wrapper"},[Y(_t,{items:v.breadcrumbs},null,8,["items"]),t("div",jt,[t("div",null,[t("h1",$t,d(v.venue?.name||"Площадка"),1),Ce.value!==null?(l(),a("div",Bt,[t("div",Tt,[(l(),a(b,null,g(5,s=>t("span",{key:s},"★")),64))]),t("span",Dt,d(Ce.value),1),Ee.value!==null?(l(),a("span",At,"("+d(Ee.value)+" отзывов)",1)):c("",!0)])):c("",!0)]),We.value?(l(),a("button",{key:0,class:"rounded-full border border-slate-900 bg-slate-900 px-4 py-2 text-sm font-semibold text-white transition hover:-translate-y-0.5 hover:bg-slate-800",type:"button",onClick:ut}," Редактировать ")):c("",!0)]),t("div",Ft,[te.value?(l(),a("div",{key:0,style:ge({height:`${D.value}px`})},null,4)):c("",!0),t("div",{ref_key:"anchorNavRef",ref:ue,class:E(["border-b border-slate-200/80 bg-white/90 py-3 backdrop-blur",te.value?"fixed z-30 px-6 shadow-[0_6px_18px_rgba(15,23,42,0.06)]":"relative"]),style:ge(te.value?{top:`${se.value}px`,left:`${De.value}px`,width:`${Ae.value}px`}:{})},[e[14]||(e[14]=t("p",{class:"text-xs font-semibold uppercase tracking-[0.2em] text-slate-400"},"Навигация",-1)),t("div",Nt,[(l(),a(b,null,g(j,s=>t("button",{key:s.id,type:"button",class:E(["rounded-full border px-4 py-2 text-sm font-semibold transition",Be.value===s.id?"border-slate-900 bg-slate-900 text-white":"border-slate-200 bg-white text-slate-600 hover:border-slate-300"]),onClick:u=>Ke(s.id)},d(s.label),11,Ut)),64))])],6),t("div",Lt,[t("section",{id:j[0].id,ref:ee("address"),class:"scroll-mt-24 space-y-4"},[e[15]||(e[15]=t("div",{class:"flex items-center justify-between gap-3"},[t("h2",{class:"text-lg font-semibold text-slate-900"},"Адрес"),t("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-400"},"Карта")],-1)),t("div",Mt,[t("div",{ref_key:"mapRef",ref:me,class:"h-64 w-full"},null,512),P.value?(l(),a("div",Ot,d(P.value),1)):c("",!0)]),t("div",It,[v.venue?.address?.metro?(l(),a("div",qt,[t("span",{class:"h-2.5 w-2.5 rounded-full",style:ge({backgroundColor:v.venue?.address?.metro?.line_color||"#94a3b8"})},null,4),t("span",null,d(fe(v.venue?.address?.metro)),1)])):c("",!0),t("p",Pt,d(v.venue?.address?.display||"Адрес не указан."),1),je.value?(l(),a("a",{key:1,href:je.value,class:"inline-flex items-center gap-2 text-sm font-semibold text-slate-700 transition hover:text-slate-900",target:"_blank",rel:"noopener noreferrer"}," Маршрут ",8,zt)):c("",!0)])],8,Vt),t("section",{id:j[1].id,ref:ee("schedule"),class:"scroll-mt-24 space-y-4"},[t("div",Ht,[e[16]||(e[16]=t("div",null,[t("h2",{class:"text-lg font-semibold text-slate-900"},"Расписание"),t("p",{class:"mt-1 text-sm text-slate-600"},"Ближайшие две недели.")],-1)),t("a",{href:Ye.value,class:"rounded-full border border-slate-200 px-4 py-2 text-xs font-semibold text-slate-600 transition hover:border-slate-300 hover:text-slate-800"}," Подробнее ",8,Wt)]),t("div",Kt,[(l(),a(b,null,g(ot,s=>t("span",{key:s,class:"text-center"},d(s),1)),64))]),G.value.length?(l(),a("div",Qt,[(l(!0),a(b,null,g(G.value,s=>(l(),a("button",{key:s.date,type:"button",class:E(["relative flex flex-col gap-2 rounded-2xl border border-slate-200 bg-white px-4 py-3 text-left transition hover:-translate-y-0.5 hover:border-slate-300",{"ring-2 ring-emerald-200":s.is_today}]),onClick:u=>Qe(s)},[t("div",Gt,[t("span",Jt,d(at(s.date))+", ",1),U(" "+d(Le(s.date)),1)]),t("span",{class:E(["absolute right-4 top-3.5 h-2.5 w-2.5 rounded-full",s.is_closed_by_exception?"bg-rose-500":s.intervals?.length?"bg-emerald-500":"bg-slate-400"])},null,2),s.bookings?.length?(l(),a("span",Xt)):c("",!0),t("div",es,[s.is_closed_by_exception?(l(),a("p",ts,"Закрыто")):s.intervals?.length?(l(),a("div",ss,[(l(!0),a(b,null,g(s.intervals,(u,C)=>(l(),a("div",{key:C,class:"text-xs font-normal text-slate-700"},d(u.starts_at)+"–"+d(u.ends_at),1))),128))])):(l(),a("p",ls,"-"))])],10,Zt))),128))])):(l(),a("p",as,"Расписание пока не задано.")),G.value.length?(l(),a("div",os,[...e[17]||(e[17]=[he('<div class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-emerald-500"></span> Открыто </div><div class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-violet-500"></span> Есть бронирования </div><div class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-slate-400"></span> Нет интервалов </div><div class="flex items-center gap-2"><span class="h-2 w-2 rounded-full bg-rose-500"></span> Закрыто </div>',4)])])):c("",!0)],8,Yt),t("section",{id:j[2].id,ref:ee("posts"),class:"scroll-mt-24 space-y-4"},[t("div",ns,[e[18]||(e[18]=t("h2",{class:"text-lg font-semibold text-slate-900"},"Последние посты",-1)),t("a",{href:Se.value,class:"rounded-full border border-slate-200 px-4 py-2 text-xs font-semibold text-slate-600 transition hover:border-slate-300 hover:text-slate-800"}," Подробнее ",8,ds)]),e[19]||(e[19]=he('<div class="grid gap-3 md:grid-cols-2"><div class="rounded-2xl border border-slate-200 bg-white px-4 py-4"><p class="text-sm font-semibold text-slate-900">Турнир выходного дня</p><p class="mt-1 text-sm text-slate-600">Скоро анонсируем новые события площадки.</p><p class="mt-3 text-xs uppercase tracking-[0.15em] text-slate-400">Раздел в разработке</p></div><div class="rounded-2xl border border-slate-200 bg-white px-4 py-4"><p class="text-sm font-semibold text-slate-900">Обновление расписания</p><p class="mt-1 text-sm text-slate-600">Следите за свежими новостями и изменениями.</p><p class="mt-3 text-xs uppercase tracking-[0.15em] text-slate-400">Раздел в разработке</p></div></div>',1))],8,rs),t("section",{id:j[3].id,ref:ee("reviews"),class:"scroll-mt-24 space-y-4"},[t("div",us,[e[20]||(e[20]=t("h2",{class:"text-lg font-semibold text-slate-900"},"Отзывы",-1)),t("a",{href:Se.value,class:"rounded-full border border-slate-200 px-4 py-2 text-xs font-semibold text-slate-600 transition hover:border-slate-300 hover:text-slate-800"}," Подробнее ",8,cs)]),e[21]||(e[21]=he('<div class="grid gap-3 md:grid-cols-2"><div class="rounded-2xl border border-slate-200 bg-white px-4 py-4"><p class="text-sm font-semibold text-slate-900">Отличный зал</p><p class="mt-1 text-sm text-slate-600">Покрытие и освещение — супер.</p><p class="mt-3 text-xs uppercase tracking-[0.15em] text-slate-400">Раздел в разработке</p></div><div class="rounded-2xl border border-slate-200 bg-white px-4 py-4"><p class="text-sm font-semibold text-slate-900">Удобная локация</p><p class="mt-1 text-sm text-slate-600">Рядом метро и парковка.</p><p class="mt-3 text-xs uppercase tracking-[0.15em] text-slate-400">Раздел в разработке</p></div></div>',1))],8,is)])]),t("div",{class:E(["mt-6 rounded-2xl border border-slate-200 bg-slate-50 p-4",{loading:i(K).processing}])},[t("div",ps,[e[22]||(e[22]=t("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Статус",-1)),t("div",vs,[v.venue?.status==="confirmed"?(l(),a("span",{key:0,class:"rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-xs font-semibold text-emerald-700",title:be(v.venue?.confirmed_at)}," Подтверждено ",8,ms)):v.venue?.status==="blocked"?(l(),a("span",xs," Заблокировано ")):Ve.value?(l(),a("span",{key:2,class:"rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-xs font-semibold text-amber-800",title:be($.value?.submitted_at)}," На модерации ",8,bs)):z.value&&!Me.value?(l(),a("span",{key:3,class:"rounded-full border border-rose-200 bg-rose-50 px-2 py-0.5 text-xs font-semibold text-rose-700",title:be(dt.value)}," Отклонено ",8,fs)):c("",!0),z.value&&de.value&&v.venue?.status==="unconfirmed"?(l(),a("button",{key:4,class:"rounded-full border border-slate-900 bg-slate-900 px-3 py-1 text-xs font-semibold text-white transition hover:-translate-y-0.5 hover:bg-slate-800",type:"button",disabled:i(K).processing,onClick:Oe}," Отправить повторно ",8,ys)):!Ve.value&&!z.value&&v.venue?.status==="unconfirmed"&&de.value?(l(),a("button",{key:5,class:"rounded-full border border-slate-900 bg-slate-900 px-3 py-1 text-xs font-semibold text-white transition hover:-translate-y-0.5 hover:bg-slate-800",type:"button",disabled:i(K).processing,onClick:Oe}," Отправить на модерацию ",8,gs)):c("",!0)])]),t("div",hs,[B.value.length?(l(),a("div",_s,[e[23]||(e[23]=t("p",{class:"font-semibold"},"Не выполнены требования:",-1)),t("ul",ks,[(l(!0),a(b,null,g(B.value,(s,u)=>(l(),a("li",{key:u},d(s),1))),128))])])):z.value&&Me.value?(l(),a("div",ws,d(it.value),1)):z.value?(l(),a("div",Ss," Причина отклонения пока не указана. ")):v.venue?.status==="blocked"?(l(),a("div",Cs,d(v.venue?.block_reason||"Причина блокировки не определена."),1)):Q.value?(l(),a("div",Es,d(Q.value),1)):c("",!0)])],2),t("div",Rs,[t("div",js,[e[24]||(e[24]=t("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Тип",-1)),t("span",$s,d(v.venue?.type?.name||"—"),1)]),t("div",Bs,[e[25]||(e[25]=t("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Адрес",-1)),t("span",Ts,d(v.venue?.address?.display||"-"),1)]),t("div",Ds,[e[26]||(e[26]=t("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Метро",-1)),t("span",As,d(fe(v.venue?.address?.metro)),1)]),t("div",Fs,[e[27]||(e[27]=t("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Комментарий",-1)),t("span",Ns,d(v.venue?.commentary||"-"),1)]),t("div",Us,[e[28]||(e[28]=t("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Создатель",-1)),t("span",Ls,d(v.venue?.creator?.login||"—"),1)]),t("div",Vs,[e[29]||(e[29]=t("span",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"Создана",-1)),t("span",Ms,d(v.venue?.created_at||"—"),1)])])],512)],2),Y(St,{"app-name":v.appName},null,8,["app-name"])]),x.value?(l(),a("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 px-4",onClick:_e(F,["self"])},[t("div",Os,[t("div",Is,[t("div",null,[e[30]||(e[30]=t("h2",{class:"text-lg font-semibold text-slate-900"},"Расписание на день",-1)),t("p",qs,d(Le(x.value.date)),1)]),t("button",{class:"rounded-full border border-slate-200 px-2.5 py-1 text-sm text-slate-500 transition hover:border-slate-300 hover:text-slate-700",type:"button","aria-label":"Закрыть",onClick:F}," x ")]),t("div",{ref_key:"popupBodyRef",ref:Ue,class:E(["popup-body max-h-[500px] overflow-y-auto px-6 pt-4",{loading:S.value}])},[q.value?(l(),a("div",Ps,d(q.value),1)):S.value?(l(),a("div",zs,[...e[31]||(e[31]=[t("div",{class:"h-6 w-6 animate-spin rounded-full border-2 border-slate-300 border-t-slate-600"},null,-1)])])):(l(),a(b,{key:2},[x.value.is_closed?(l(),a("div",Ys," Площадка закрыта. ")):X.value?(l(),a("div",Hs," Бронирование недоступно для неподтвержденной площадки. ")):(l(),a("div",Ws,[e[32]||(e[32]=t("p",{class:"text-xs uppercase tracking-[0.15em] text-slate-500"},"График работы",-1)),x.value.intervals?.length?(l(),a("div",Ks,[(l(!0),a(b,null,g(x.value.intervals,(s,u)=>(l(),a("div",{key:u},d(s.starts_at)+"–"+d(s.ends_at),1))),128))])):(l(),a("p",Qs,"Интервалы не заданы."))])),x.value.is_closed?(l(),a("div",Zs,[t("div",Gs,[x.value.is_closed_by_exception?c("",!0):(l(),a("p",Js,"Интервалы не заданы.")),x.value.comment?(l(),a("p",Xs,d(x.value.comment),1)):c("",!0)])])):X.value?c("",!0):(l(),a("div",el,[e[33]||(e[33]=t("p",{class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},"Занятые интервалы",-1)),x.value.bookings?.length?(l(),a("div",tl,[(l(!0),a(b,null,g(x.value.bookings,(s,u)=>(l(),a("span",{key:u,class:"rounded-full border border-slate-200 bg-white px-3 py-1 text-xs text-slate-700"},d(s.starts_at)+"–"+d(s.ends_at),1))),128))])):(l(),a("p",sl,"Бронирований нет."))])),w.value?(l(),a("div",{key:5,ref_key:"bookingFormRef",ref:Ne,class:"mt-6"},[e[34]||(e[34]=t("hr",{class:"my-4 border-slate-200/80"},null,-1)),e[35]||(e[35]=t("p",{class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},"Забронировать",-1)),e[36]||(e[36]=t("div",{class:"mt-2"},null,-1)),Y(kt,{ref_key:"embeddedCreateRef",ref:N,embedded:"",prefill:ve.value,"can-book-fallback":!1,"hide-submit":!0,onClose:F,onLoaded:tt,onBookingConflict:Je},null,8,["prefill"])],512)):c("",!0)],64))],2),t("div",ll,[S.value?(l(),a("button",{key:0,class:"rounded-full border border-slate-200 px-4 py-2 text-sm text-slate-600 transition hover:-translate-y-0.5 hover:border-slate-300",type:"button",onClick:F}," Закрыть ")):c("",!0),x.value.is_closed?(l(),a("button",{key:1,class:"rounded-full border border-slate-200 px-4 py-2 text-sm text-slate-600 transition hover:-translate-y-0.5 hover:border-slate-300",type:"button",onClick:F}," Закрыть ")):c("",!0),!S.value&&!x.value.is_closed&&X.value?(l(),a("button",{key:2,class:"rounded-full border border-slate-200 px-4 py-2 text-sm text-slate-600 transition hover:-translate-y-0.5 hover:border-slate-300",type:"button",onClick:F}," Закрыть ")):c("",!0),w.value&&!x.value.is_closed?(l(),a("button",{key:3,class:"rounded-full border border-slate-200 px-4 py-2 text-sm text-slate-600 transition hover:-translate-y-0.5 hover:border-slate-300",type:"button",onClick:Ze}," Отмена ")):c("",!0),!x.value.is_closed&&!S.value&&!X.value?(l(),a("button",{key:4,class:"rounded-full border border-slate-900 bg-slate-900 px-4 py-2 text-sm font-semibold text-white transition hover:-translate-y-0.5 hover:bg-slate-800 disabled:cursor-not-allowed disabled:border-slate-300 disabled:bg-slate-200 disabled:text-slate-500 disabled:hover:translate-y-0",type:"button",disabled:w.value?lt.value:!1,onClick:e[1]||(e[1]=s=>w.value?st():et())},d(w.value?"Подтвердить":"Забронировать"),9,al)):c("",!0)])])])):c("",!0),oe.value?(l(),a("div",{key:1,class:"fixed inset-0 z-50 flex items-center justify-center bg-slate-900/40 px-4",onClick:_e(ye,["self"])},[t("div",ol,[t("form",{class:E({loading:i(r).processing}),onSubmit:_e(ct,["prevent"])},[t("div",{class:"popup-header flex items-center justify-between border-b border-slate-200/80 px-6 py-4"},[e[37]||(e[37]=t("h2",{class:"text-lg font-semibold text-slate-900"},"Редактировать площадку",-1)),t("button",{class:"rounded-full border border-slate-200 px-2.5 py-1 text-sm text-slate-500 transition hover:border-slate-300 hover:text-slate-700",type:"button","aria-label":"Закрыть",onClick:ye}," x ")]),t("div",rl,[e[44]||(e[44]=t("p",{class:"text-sm text-slate-600"},"Заполните доступные поля площадки.",-1)),I.value||J.value?(l(),a("div",nl,[t("p",dl,d(I.value?"Подтвержденная информация":"Данная информация на модерации"),1),$e.value.length?(l(),a("div",il,[(l(!0),a(b,null,g($e.value,s=>(l(),a("div",{key:s.key,class:"flex items-center justify-between gap-3"},[t("span",ul,d(s.label),1),t("span",cl,d(s.value),1)]))),128))])):c("",!0)])):c("",!0),_.value.length?(l(),a("div",pl,[_.value.includes("venue_type_id")?(l(),a("div",vl,[t("label",ml,[e[39]||(e[39]=U(" Тип ",-1)),k(t("select",{"onUpdate:modelValue":e[2]||(e[2]=s=>i(r).venue_type_id=s),class:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700"},[e[38]||(e[38]=t("option",{value:""},"Выберите тип",-1)),(l(!0),a(b,null,g(ze.value,s=>(l(),a("option",{key:s.id,value:s.id},d(s.name),9,xl))),128))],512),[[gt,i(r).venue_type_id]])]),i(r).errors.venue_type_id?(l(),a("div",bl,d(i(r).errors.venue_type_id),1)):c("",!0)])):c("",!0),_.value.includes("name")?(l(),a("div",fl,[t("label",yl,[e[40]||(e[40]=U(" Название ",-1)),k(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>i(r).name=s),class:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700",type:"text",placeholder:"Например, Арена 11"},null,512),[[R,i(r).name]])]),i(r).errors.name?(l(),a("div",gl,d(i(r).errors.name),1)):c("",!0)])):c("",!0),He.value&&!I.value&&!J.value?(l(),a("div",hl,[t("label",_l,[e[41]||(e[41]=U(" Адрес ",-1)),k(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>M.value=s),onInput:e[5]||(e[5]=s=>pt(s.target.value)),class:E(["input-predictive rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700",{"is-loading":Z.value}]),type:"text",placeholder:"Начните вводить адрес"},null,34),[[R,M.value]])]),k(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>i(r).city=s),type:"hidden"},null,512),[[R,i(r).city]]),k(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>i(r).metro_id=s),type:"hidden"},null,512),[[R,i(r).metro_id]]),k(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>i(r).street=s),type:"hidden"},null,512),[[R,i(r).street]]),k(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>i(r).building=s),type:"hidden"},null,512),[[R,i(r).building]]),k(t("input",{"onUpdate:modelValue":e[10]||(e[10]=s=>i(r).str_address=s),type:"hidden"},null,512),[[R,i(r).str_address]]),f.value?(l(),a("div",kl,d(f.value),1)):!Z.value&&h.value.length?(l(),a("div",wl,[(l(!0),a(b,null,g(h.value,(s,u)=>(l(),a("button",{key:`${s.label}-${u}`,class:"block w-full border-b border-slate-100 px-3 py-2 text-left last:border-b-0 hover:bg-slate-50 disabled:cursor-not-allowed disabled:text-slate-400",type:"button",disabled:!s.has_house,onClick:C=>mt(s)},d(s.label),9,Sl))),128))])):c("",!0),i(r).errors.city||i(r).errors.street||i(r).errors.building?(l(),a("div",Cl,d(i(r).errors.city||i(r).errors.street||i(r).errors.building),1)):c("",!0)])):c("",!0),_.value.includes("str_address")&&(I.value||J.value)?(l(),a("div",El,[t("label",Rl,[e[42]||(e[42]=U(" Адрес (строкой) ",-1)),k(t("input",{"onUpdate:modelValue":e[11]||(e[11]=s=>i(r).str_address=s),class:"rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700",type:"text",placeholder:"Например, Россия, Москва, Тверская, 1"},null,512),[[R,i(r).str_address]])]),i(r).errors.str_address?(l(),a("div",jl,d(i(r).errors.str_address),1)):c("",!0)])):c("",!0),_.value.includes("commentary")?(l(),a("div",$l,[t("label",Bl,[e[43]||(e[43]=U(" Комментарий ",-1)),k(t("textarea",{"onUpdate:modelValue":e[12]||(e[12]=s=>i(r).commentary=s),class:"min-h-[96px] rounded-xl border border-slate-200 bg-white px-3 py-2 text-sm text-slate-700",placeholder:"Дополнительная информация"},null,512),[[R,i(r).commentary]])]),i(r).errors.commentary?(l(),a("div",Tl,d(i(r).errors.commentary),1)):c("",!0)])):c("",!0)])):c("",!0),i(r).errors.venue?(l(),a("div",Dl,d(i(r).errors.venue),1)):V.value?(l(),a("div",Al,d(V.value),1)):c("",!0)]),t("div",Fl,[t("button",{class:"rounded-full border border-slate-200 px-4 py-2 text-sm text-slate-600 transition hover:-translate-y-0.5 hover:border-slate-300",type:"button",disabled:i(r).processing,onClick:ye}," Закрыть ",8,Nl),t("button",{class:"rounded-full border border-slate-900 bg-slate-900 px-4 py-2 text-sm font-semibold text-white transition hover:-translate-y-0.5 hover:bg-slate-800",type:"submit",disabled:i(r).processing||!_.value.length}," Сохранить ",8,Ul)])],34)])])):c("",!0),Y(ht,{"app-name":v.appName,"is-open":L.value,"participant-roles":i(H).props.participantRoles||[],"initial-mode":W.value,onClose:e[13]||(e[13]=s=>L.value=!1)},null,8,["app-name","is-open","participant-roles","initial-mode"])]))}};export{Pl as default};
