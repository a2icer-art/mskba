import{u as $,r as j,w as E,a as V,c as p,b as n,e as g,d as t,t as d,n as v,l as C,h as l,j as u,k as m,m as L,B as R,v as z,F as A,i as D,o as i}from"./app-BG8bJDk_.js";const O={key:0,class:"fixed inset-0 z-50 flex items-center justify-center px-4 py-10"},P={class:"relative w-full max-w-md rounded-3xl border border-slate-200 bg-white shadow-xl"},T={class:"popup-header flex items-center justify-between border-b border-slate-200/80 px-6 py-4"},I={class:"mt-2 text-2xl font-semibold text-slate-900"},h={class:"popup-body max-h-[500px] overflow-y-auto px-6 pt-4"},G={class:"inline-flex rounded-full border border-slate-200 bg-slate-50 p-1 text-xs uppercase tracking-[0.2em] text-slate-500"},H={key:0,class:"rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-700"},J={class:"flex items-center gap-2 text-sm text-slate-600"},K={key:1,class:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},Q=["value"],W={key:0,class:"rounded-2xl border border-rose-200 bg-rose-50 px-4 py-3 text-sm text-rose-700"},X={class:"popup-footer flex flex-wrap justify-end gap-3 border-t border-slate-200/80 px-6 py-4"},Y=["form","disabled"],_={__name:"AuthModal",props:{isOpen:{type:Boolean,required:!0},appName:{type:String,required:!0},participantRoles:{type:Array,default:()=>[]},initialMode:{type:String,default:"login"}},emits:["close"],setup(b,{emit:M}){const f=b,x=M,c=$(),a=j(f.initialMode);E(()=>f.initialMode,S=>{a.value=S});const r=V({login:"",password:"",remember:!1}),o=V({login:"",email:"",password:"",participant_role_id:""}),y=p(()=>r.errors.login||r.errors.password||c.props.errors?.login),w=p(()=>c.props.flash?.info||""),k=p(()=>o.errors.login||o.errors.email||o.errors.password||o.errors.participant_role_id),U=p(()=>a.value==="login"?"auth-login-form":"auth-register-form"),q=p(()=>a.value==="login"?"Войти":"Зарегистрироваться"),F=p(()=>a.value==="login"?r.processing:o.processing),N=()=>{r.post("/login",{preserveScroll:!0,onSuccess:()=>{r.reset("password"),x("close")}})},B=()=>{o.post("/register",{preserveScroll:!0,onSuccess:()=>{o.reset("login","email","password","participant_role_id"),x("close")}})};return(S,e)=>b.isOpen?(i(),n("div",O,[t("div",{class:"absolute inset-0 bg-slate-900/60 backdrop-blur-sm",onClick:e[0]||(e[0]=s=>x("close"))}),t("div",P,[t("div",T,[t("div",null,[e[12]||(e[12]=t("p",{class:"text-xs uppercase tracking-[0.2em] text-slate-500"},"Авторизация",-1)),t("h2",I,d(a.value==="login"?"Войти":"Регистрация")+" в "+d(b.appName),1)]),t("button",{class:"rounded-full border border-slate-200 px-2.5 py-1 text-sm text-slate-500 transition hover:border-slate-300 hover:text-slate-700",type:"button","aria-label":"Закрыть",onClick:e[1]||(e[1]=s=>x("close"))}," x ")]),t("div",h,[t("div",G,[t("button",{class:v(["rounded-full px-4 py-2 transition",a.value==="login"?"bg-white text-slate-900 shadow-sm":"hover:text-slate-700"]),type:"button",onClick:e[2]||(e[2]=s=>a.value="login")}," Войти ",2),t("button",{class:v(["rounded-full px-4 py-2 transition",a.value==="register"?"bg-white text-slate-900 shadow-sm":"hover:text-slate-700"]),type:"button",onClick:e[3]||(e[3]=s=>a.value="register")}," Регистрация ",2)]),a.value==="login"?(i(),n("form",{key:0,id:"auth-login-form",class:v(["mt-6 space-y-4",{loading:l(r).processing}]),onSubmit:C(N,["prevent"])},[w.value?(i(),n("div",H,d(w.value),1)):g("",!0),t("div",null,[e[13]||(e[13]=t("label",{class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},"Логин",-1)),u(t("input",{"onUpdate:modelValue":e[4]||(e[4]=s=>l(r).login=s),class:"mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-700 focus:border-slate-400 focus:outline-none",type:"text",autocomplete:"username",required:""},null,512),[[m,l(r).login]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},"Пароль",-1)),u(t("input",{"onUpdate:modelValue":e[5]||(e[5]=s=>l(r).password=s),class:"mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-700 focus:border-slate-400 focus:outline-none",type:"password",autocomplete:"current-password",required:""},null,512),[[m,l(r).password]])]),t("label",J,[u(t("input",{"onUpdate:modelValue":e[6]||(e[6]=s=>l(r).remember=s),class:"h-4 w-4 rounded border-slate-300",type:"checkbox"},null,512),[[R,l(r).remember]]),e[15]||(e[15]=L(" Запомнить меня ",-1))]),y.value?(i(),n("div",K,d(y.value),1)):g("",!0)],34)):(i(),n("form",{key:1,id:"auth-register-form",class:v(["mt-6 space-y-4",{loading:l(o).processing}]),onSubmit:C(B,["prevent"])},[e[22]||(e[22]=t("p",{class:"text-xs text-slate-500"},"Поля со * обязательные.",-1)),t("div",null,[e[16]||(e[16]=t("label",{class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},"Логин *",-1)),u(t("input",{"onUpdate:modelValue":e[7]||(e[7]=s=>l(o).login=s),class:"mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-700 focus:border-slate-400 focus:outline-none",type:"text",autocomplete:"username",required:""},null,512),[[m,l(o).login]])]),t("div",null,[e[17]||(e[17]=t("label",{class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},"Email",-1)),u(t("input",{"onUpdate:modelValue":e[8]||(e[8]=s=>l(o).email=s),class:"mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-700 focus:border-slate-400 focus:outline-none",type:"email",autocomplete:"email"},null,512),[[m,l(o).email]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},"Пароль *",-1)),u(t("input",{"onUpdate:modelValue":e[9]||(e[9]=s=>l(o).password=s),class:"mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-700 focus:border-slate-400 focus:outline-none",type:"password",autocomplete:"new-password",required:""},null,512),[[m,l(o).password]]),e[19]||(e[19]=t("p",{class:"mt-2 text-xs text-slate-500"},"Минимум 6 символов, буквы и цифры.",-1))]),t("div",null,[e[21]||(e[21]=t("label",{class:"text-xs font-semibold uppercase tracking-[0.15em] text-slate-500"},"Роль",-1)),u(t("select",{"onUpdate:modelValue":e[10]||(e[10]=s=>l(o).participant_role_id=s),class:"mt-2 w-full rounded-2xl border border-slate-200 bg-slate-50 px-4 py-3 text-sm text-slate-700 focus:border-slate-400 focus:outline-none"},[e[20]||(e[20]=t("option",{value:""},"Без роли",-1)),(i(!0),n(A,null,D(b.participantRoles,s=>(i(),n("option",{key:s.id,value:s.id},d(s.name),9,Q))),128))],512),[[z,l(o).participant_role_id]])]),k.value?(i(),n("div",W,d(k.value),1)):g("",!0)],34))]),t("div",X,[t("button",{class:"rounded-full border border-slate-200 px-4 py-2 text-sm text-slate-600 transition hover:-translate-y-0.5 hover:border-slate-300",type:"button",onClick:e[11]||(e[11]=s=>x("close"))}," Закрыть "),t("button",{class:"rounded-full border border-slate-900 bg-slate-900 px-4 py-2 text-sm font-semibold text-white transition hover:-translate-y-0.5 hover:bg-slate-800 disabled:cursor-not-allowed disabled:border-slate-300 disabled:bg-slate-200 disabled:text-slate-500 disabled:hover:translate-y-0",type:"submit",form:U.value,disabled:F.value},d(q.value),9,Y)])])])):g("",!0)}};export{_};
