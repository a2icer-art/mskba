# Задача 095

- task_name: Страница супервайзера и обработка комиссии
- task_status: выполнено
- task_init_description: нет, думаю пришло время для страницы супервайзера #set_task 095 - изучи документацию проекта чтобы понять в чем идея
- task_short_description: Разработать страницу супервайзера площадки и логику обработки комиссии, опираясь на процессы модерации контрактов и роль супервайзера в проектной документации.

## full_description
Реализовать страницу супервайзера площадки и поддержку комиссии в бронированиях, учитывая правила контрактов (один активный супервайзер, права только по бронированиям) и текущий процесс бронирования/оплаты. Комиссия должна поддерживать режимы «проценты» и «фиксированная надбавка», с валидируемым вводом и корректным расчетом суммы.

## План выполнения задачи
1) Уточнить требования и точки влияния комиссии на цену/процессы (бронь, подтверждение, уведомления). (subtasks/095-1-analysis.md)
2) Спроектировать хранение и расчёт комиссии (модель/настройки/формула/валидации). (subtasks/095-2-domain.md)
3) Реализовать раздел «Супервайзер» в UI и права доступа, связать с настройками комиссии. (subtasks/095-3-ui.md)
4) Подключить расчёт комиссии в бронированиях и отображение в карточках/попапах. (subtasks/095-4-bookings.md)
5) Проверить сценарии и обновить документацию. (subtasks/095-5-verify-docs.md)

## Итог
- Добавлен раздел супервайзера с настройкой комиссии и отображением активного статуса.
- Комиссия поддерживает режимы процентов и фиксированной надбавки, валидируется и сохраняется в `venue_settings`.
- Комиссия учитывается при расчёте суммы бронирования и фиксируется в `payments.meta`.
- Обновлены UI бронирований и страницы контрактов/модерации (права супервайзинга показываются только для контракта супервайзера).
- Доступ к супервайзингу ограничен admin или активным супервайзером с правами `venue.supervisor.view/manage`.
