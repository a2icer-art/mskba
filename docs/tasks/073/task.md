# task_name
Система уведомлений и сообщений

# task_status
[x]

# task_init_description
Разработать систему уведомлений: типы уведомлений (системные и сообщения между пользователями), входящие и исходящие. Добавить настройки пользователя: кто может отправлять сообщения (никто, все по умолчанию, группы — коллеги/друзья и т.п., только определенные пользователи), а также черный список. Системные уведомления от ограничений по отправителям не зависят. Добавить страницу сообщений в /account со списком диалогов и последним сообщением, ссылку в sidebar с бейджем количества. В header у логина показывать индикатор непрочитанных сообщений (кружок с числом, если >9 — троеточие).

# task_short_description
Система уведомлений и сообщений: типы, диалоги, настройки приватности, UI счетчиков и раздел сообщений.

# task_full_description
Нужно спроектировать и реализовать единую систему уведомлений, включающую системные уведомления и пользовательские сообщения. Для пользовательских сообщений требуется понятие входящих/исходящих, списки диалогов и отображение последнего сообщения. У пользователя должны быть настройки приватности отправки сообщений: никто, все (по умолчанию), группы (коллеги/друзья — в будущем), только определенные пользователи, а также черный список. Системные уведомления не зависят от приватности, не удаляются и должны автоматически содержать ссылки на релевантные сущности и ответственных пользователей (например, по контрактам), чтобы по клику открывался диалог. Статусы сообщений: прочитано/непрочитано, удалено — изменения статусов фиксируются. Интерфейс: /account/messages с двумя колонками (слева список диалогов, справа переписка), ссылка в sidebar с бейджем непрочитанных, индикатор в header у логина (если >9 — троеточие). Для обновления — JS‑polling раз в 5 секунд (централизовано), без WebSockets на первом этапе.

# План выполнения задачи
1. Доменная модель и миграции: Notifications, Conversations, Messages, настройки приватности, allow/block списки. (subtasks/01_domain.md)
2. UseCases/Services: отправка сообщений, системные уведомления, фиксация статусов, получение диалогов и непрочитанных. (subtasks/02_services.md)
3. API/Controllers + Presentation: выдача диалогов, сообщений, счетчиков, системных уведомлений. (subtasks/03_api.md)
4. UI: /account/messages (две колонки), sidebar badge, header indicator. (subtasks/04_ui.md)
5. JS‑polling: централизованный механизм обновления (5 сек). (subtasks/05_polling.md)
6. Документация и фиксация проверок. (subtasks/06_docs.md)
